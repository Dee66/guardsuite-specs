metadata:
  product_id: vectorguard
  checklist_version: '2026.04'
  last_updated: '2025-11-25T00:00:00Z'
  owner: GuardSuite PMO
  stability: ga
states: {}
phases:
- phase: initialization
  items:
  - INIT-001: load_det001_spec_and_validate_yaml_structure
  - INIT-002: ensure_required_sections_present(timestamp/path/numeric/payload/hashing/schema/implementation/testing)
  - INIT-003: validate_spec_version("2026.04")
  - INIT-004: ensure_forbidden_operations_list_present
  - INIT-005: validate_required_functions_declared(normalize_path, normalize_timestamp,
      normalize_float, canonical_sort, normalize_payload)
  - INIT-006: detect_missing_schema_requirements(canonical_output_schema)
  - INIT-007: ensure_output_contract_fragments_exist
- phase: timestamp_normalization
  items:
  - TS-001: implement_normalize_timestamp_function
  - TS-002: enforce_utc_iso8601_z_format
  - TS-003: enforce_nanosecond_truncation_to_ms
  - TS-004: implement_malformed_timestamp_behavior(fallback_epoch_zero)
  - TS-005: enforce_force_utc_semantics
  - TS-006: inject_metadata_canonical_timestamp_before_hashing
  - TS-007: ensure_canonical_timestamp_included_in_human_output
  - TS-008: ensure_only_metadata_canonical_timestamp_in_hash
- phase: path_normalization
  items:
  - PATH-001: implement_normalize_path_function
  - PATH-002: convert_backslashes_to_slashes
  - PATH-003: collapse_redundant_segments
  - PATH-004: resolve_to_rooted_absolute_form
  - PATH-005: enforce_leading_slash_rule
  - PATH-006: return_empty_string_for_invalid_paths
  - PATH-007: enforce_cross_os_stability
  - PATH-008: wasm_safety_validation(no_fs, no_os_dependent_ops)
- phase: numeric_normalization
  items:
  - NUM-001: implement_fixed64_rounding_contract
  - NUM-002: apply_scale_factor_1e6
  - NUM-003: enforce_round_half_away_from_zero
  - NUM-004: convert_non_finite_values_to_zero
  - NUM-005: validate_cross_runtime_fixed64_consistency(python/wasm/native)
  - NUM-006: validate_no_float_leakage_into_output
- phase: issue_sorting
  items:
  - SORT-001: implement_canonical_sort_for_issues
  - SORT-002: enforce_sort_keys(rule_id > resource_id > severity > timestamp_utc)
  - SORT-003: implement_fallback_keys(id, resource_address)
  - SORT-004: validate_no_locale_sort_or_custom_comparator
  - SORT-005: enforce_stable_sort_across_runtimes
  - SORT-006: replace_existing_sort_issues_in_evaluator
- phase: payload_normalization
  items:
  - PAY-001: implement_normalize_payload_recursive
  - PAY-002: enforce_recursive_key_ordering
  - PAY-003: apply_unicode_normalization(NFC)
  - PAY-004: enforce_missing_fields_set_to_null
  - PAY-005: apply_list_sorting_only_where_specified
  - PAY-006: exclude_noncanonical_fields_from_hashing(diagnostics/pipeline_trace/lifecycle_state/debug*/ephemeral_*)
  - PAY-007: preserve_diagnostics_in_human_output
  - PAY-008: validate_hash_view_removes_only_specified_fields
- phase: hashing
  items:
  - HASH-001: ensure_hash_input_is_normalized_payload(strip_diagnostics=True)
  - HASH-002: enforce_sha256_hex_lowercase_output
  - HASH-003: validate_canonical_json_utf8_serialization
  - HASH-004: enforce_no_bom_or_whitespace_variation
  - HASH-005: ensure_only_metadata_canonical_timestamp_allowed_in_hash
  - HASH-006: validate_byte_for_byte_identical_hash_python_vs_wasm_vs_native
  - HASH-007: enforce_prohibitions(nondeterministic_metadata/ordering/runtime_fields)
- phase: schema_requirements
  items:
  - SCHEMA-001: create_or_validate_canonical_output_schema_file
  - SCHEMA-002: validate_required_fields_present(metadata/issues/provenance/fixpack)
  - SCHEMA-003: ensure_metadata.canonical_timestamp_required
  - SCHEMA-004: validate_schema_defines_sorting_semantics
  - SCHEMA-005: validate_schema_defines_nullable_fields
  - SCHEMA-006: enforce_schema_first_versioning
  - SCHEMA-007: validate_wasm_safe_schema_constraints
- phase: implementation
  items:
  - IMPL-001: implement_canonical_utils_required_functions
  - IMPL-002: ensure_functions_are_deterministic_and_wasm_safe
  - IMPL-003: enforce_binary_abi_mappings_required
  - IMPL-004: update_evaluator_to_call_normalize_payload_before_hash
  - IMPL-005: update_evaluator_to_inject_canonical_timestamp
  - IMPL-006: ensure_diagnostics_preserved_for_output
  - IMPL-007: enforce_pipeline_trace_and_lifecycle_state_excluded_from_hash
  - IMPL-008: prohibit_runtime_clock_access_in_evaluator
- phase: testing
  items:
  - TEST-001: snapshot_test_three_runs_identical
  - TEST-002: python_vs_wasm_parity_test
  - TEST-003: python_vs_native_parity_test
  - TEST-004: canonical_output_snapshot_stability_test
  - TEST-005: unit_test_normalize_payload
  - TEST-006: unit_test_issue_sorting
  - TEST-007: unit_test_hash_vs_output_view
  - TEST-008: unit_test_fixed64_rounding
  - TEST-009: unit_test_path_normalization_edge_cases
  - TEST-010: unit_test_timestamp_malformed_to_epoch_zero
  - TEST-011: regression_test_forbid_new_nondeterministic_fields
  - TEST-012: regression_test_forbid_clock_access
  - TEST-013: regression_test_forbid_randomness
  - TEST-014: regression_test_forbid_locale_operations
  - TEST-015: enforce_no_hash_structure_changes_without_rfc
- phase: acceptance
  items:
  - ACPT-001: deterministic_normalization_layer_valid
  - ACPT-002: hash_parity_valid_across_runtimes
  - ACPT-003: canonical_snapshot_stability_valid
  - ACPT-004: schema_canonical_output_valid
  - ACPT-005: evaluator_integrated_with_det001_correctly
  - ACPT-006: fixed64_contract_validated
  - ACPT-007: no_nondeterministic_operations_detected
items: []
x_legacy:
  acceptance_criteria:
  - id: ACPT-VG-001
    description: DET-001 normalization layer produces byte-for-byte identical hashes
      across python, wasm, and native runtimes.
    required: true
  - id: ACPT-VG-002
    description: All nondeterministic operations are detected and blocked before release.
    required: true
  artifacts:
    required_files:
    - templates/guard_pillar/schemas/output/canonical_output.json
    - artifacts/det001_schema_bundle_hash.txt
    - artifacts/det001_release_bundle_hash.txt
    required_directories:
    - src/deterministic_normalization
    - tests/determinism
    - docs/deterministic_normalization
    build_outputs:
    - artifacts/det001_release_bundle.zip
  cross_product_dependencies:
    depends_on_products:
    - guardsuite-core
    - guardscore
    - guardboard
    - vectorscan
    depends_on_schemas:
    - guardsuite-core/canonical_schema.json
    depends_on_pipeline: true
  documentation_requirements:
    readme_required: true
    product_docs_required: true
    api_reference_required: true
    examples_required: true
    changelog_required: true
    release_notes_required: true
  evaluator_requirements:
    pipeline_must_match_template: true
    canonicalization_required: true
    wasm_safety_required: true
    deterministic_output_required: true
    timestamp_normalization_required: true
    prohibited_overrides:
    - canonical.output_contract
    - evaluator.runtime_override
    - det001.normalization_layer
  fixpack_requirements:
    fixpack_catalog_required: false
    fixpack_metadata_required: false
    difficulty_taxonomy_required: false
    patch_hashing_required: false
    remediation_examples_required: false
  id: DET-001-normalization-checklist
  pillar: crosscut
  product: vectorguard
  provenance:
  - Checklist derived from Strategy-D canonical model for paid products.
  - Aligned with DET-001 governance requirements.
  schema_requirements:
    canonical_schema_required: true
    metadata_schema_required: true
    provenance_schema_required: true
    fragment_schemas_required: true
    additional_schemas:
    - templates/guard_pillar/schemas/output/canonical_output.json
  spec_source: products/vectorguard/metadata/product.yml
  structure_requirements:
  - id: STRUCT-VG-001
    description: Maintain DET-001 normalization phases in the canonical Strategy-D
      order.
    required: true
  - id: STRUCT-VG-002
    description: All hashing, normalization, implementation, testing, and acceptance
      phases must remain present.
    required: true
  testing_requirements:
    unit_tests_required: true
    integration_tests_required: true
    snapshot_tests_required: true
    parity_tests_required: true
    wasm_tests_required: true
    schema_validation_tests_required: true
    performance_tests_required: true
    minimum_coverage_percent: 90
  version: '2026.04'
