id: pipelinescan
name: PipelineScan
product_type: free_scanner
pillar: pipeline
version: "2.0.0"
status: production

short_description: >
  Free CI/CD and supply-chain misconfiguration scanner for Terraform pipelines,
  GitHub Actions, GitLab CI, and container build workflows.

long_description: |
  PipelineScan provides deterministic, offline-first CI/CD and supply-chain
  governance scanning for infrastructure pipelines. It detects workflow security
  risks, unsafe permissions, missing integrity controls, unbounded actions,
  weak artifact policies, and execution-boundary misconfigurations. It is the
  entry point to the Pipeline pillar, feeding GuardScore and GuardBoard while
  serving as the lightweight scanner for paste-to-scan CI/CD YAML and pipeline
  manifests in Playground.

purpose_summary: >
  Detect CI/CD and supply-chain misconfigurations that compromise integrity,
  security boundaries, or operational safety.

marketing:
  hero: "Secure your CI/CD pipeline before it reaches production."
  blurbs:
    - "Detect dangerous workflow permissions and unsafe triggers"
    - "Validate artifact integrity and provenance controls"
    - "Perfect for paste-to-scan GitHub Actions and GitLab CI configs"
  ctas:
    - text: "Scan your pipeline"
      href: "/playground"

architecture:
  core_dependency_id: "guardsuite-core@>=1.4.0,<2.0.0"
  schema_source: "guardsuite-core/canonical_schema.json"
  required_interfaces:
    - "I_Evaluator"
    - "I_ScannerCLI"
  override_exclusion:
    - "canonical.output_contract"
    - "evaluator.runtime_override"
  output_contract: "strict"

governance_domains:
  - workflow_permissions
  - supply_chain_integrity
  - artifact_governance
  - secret_management
  - runner_security
  - job_boundary_controls
  - drift_detection
  - observability_gaps

rule_categories:
  - "Workflow Permissions & Boundaries"
  - "Supply Chain Integrity"
  - "Artifact Hardening"
  - "Secret Management"
  - "Execution Environment Safety"
  - "Runner Hardening"
  - "Drift Detection"
  - "Telemetry & Logging Gaps"

features:
  - id: PIPE-FEAT-001
    title: "Workflow Permission Check"
    summary: "Detect unsafe GitHub/GitLab permissions and overbroad scopes."
    included: true
  - id: PIPE-FEAT-005
    title: "Signature & Integrity Validation"
    summary: "Flags missing artifact signatures or provenance metadata."
    included: true
  - id: PIPE-FEAT-010
    title: "Unsafe Trigger Detection"
    summary: "Detects risky triggers such as unprotected pull_request events."
    included: true
  - id: PIPE-FEAT-020
    title: "Secret Handling Safety"
    summary: "Detects unsafe secret usage or missing restricted contexts."
    included: true
  - id: PIPE-FEAT-030
    title: "Runner Security Checks"
    summary: "Identifies weak runner isolation or unbounded self-hosted runners."
    included: true

fixpack:
  included: false
  reference_hint_format: "fixpack:<ISSUE_ID>"
  surfaces_hints: true

compliance:
  compliance_ledger_enabled: false
  ledger_visibility: "none"

cli:
  base_command: "pipelinescan"
  scan_command: "pipelinescan scan"
  supported_flags:
    - "--json"
    - "--stdin"
    - "--quiet"
    - "--explain"
    - "--output json"
  reserved_flags:
    - "--compliance-ledger"
    - "--fixpack-summary"

performance_constraints:
  max_memory_mb: 160
  expected_runtime_ms: 450
  large_plan_runtime_ms: 1100
  playground_runtime_ms: 1400
  quickscore_threshold_resources: 800

ecosystem_integrations:

  guardscore:
    pillar_weight: 0.33
    severity_penalties:
      critical: 40
      high: 25
      medium: 10
      low: 2
    provided_score_inputs:
      - issue_count_by_severity
      - artifact_integrity_risk
      - workflow_permission_risk
      - resource_count
    badge_eligibility_signal: true

  playground:
    wasm_safe: true
    max_runtime_ms: 2000
    playground_latency_target_ms: 1500
    json_sanitize: true
    svg_sanitize: true
    quick_score_mode: true

  guardboard:
    exposes_fixpack_hints: true
    shows_compliance_ledger: false
    badge_preview_supported: true

testing:
  unit_tests_required: true
  integration_tests_required: true
  snapshot_schema_test: true
  test_coverage_min_percent: 80
  ci_jobs:
    - validate_schema
    - unit
    - integration
    - snapshot_conformance

versioning:
  semver: true
  core_dependency_pin: "guardsuite-core@>=1.4.0,<2.0.0"
  schema_version_pin: "canonical_schema@1.0.0"
  breaking_change_policy: >
    Any breaking change requires a guardsuite-core RFC and a coordinated
    schema update across vector, compute, and pipeline pillars.

interoperability_conflicts:
  - "Future supply-chain provenance models may require additional GuardScore inputs."
  - "Artifact integrity heuristics may require schema evolution."

future_extensions:
  - "End-to-end supply-chain provenance scoring"
  - "SBOM pattern detection"
  - "Advanced runner sandbox orchestration rules"

security:
  no_external_calls_at_runtime: true
  sanitize_all_inputs: true
  svg_sanitization: true
  wasm_compatible: true
  sandbox_requirement: "Playground runtime must be WASM sandboxed"
  safe_error_reporting: true

maintainers:
  - name: "Deon Prinsloo"
    role: "AI Solutions Architect"
    contact: "deon@shieldcraft-ai.com"

release_metadata:
  release_channel: "stable"
  release_notes_url: "https://shieldcraft-ai.com/guardsuite/pipelinescan/releases/2.0.0"
  published_date: "2025-11-19"

references:
  master_spec: "docs/guardsuite_master_spec.md"
  template_spec: "templates/spec_page.md.j2"
  canonical_schema: "guardsuite-core/canonical_schema.json"

metadata:
  version: "2025.11"
  funnel_stage: bottom_funnel
  pricing_reference: "pricing/guardsuite_pricing.yml"
  ux_goals:
    - "Detect pipeline misconfigurations"
    - "Feed GuardBoard remediation queues"
governance:
  spec_version: "2025.11"
  last_reviewed: "2025-11-23"
  owner: "GuardSuite PMO"
  stability_level: ga
contract_ref: null
related_products:
  - pipelineguard
  - guardscore
  - guardboard
  - playground
