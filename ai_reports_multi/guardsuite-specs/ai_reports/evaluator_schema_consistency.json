{
  "generated": "2025-11-27T12:10:00Z",
  "source_inputs": [
    "ai_reports/evaluator_schema_detection.json",
    "ai_reports/pillar_map.json",
    "guardsuite-core/canonical_schema.json"
  ],
  "vector": {
    "matched_evaluators": [],
    "matched_schemas": [],
    "missing_evaluators": [
      "rule_specs/vectorguard/evaluator.py",
      "rule_specs/vectorscan/evaluator.py"
    ],
    "missing_schemas": [
      "products/vectorguard/schema.yml",
      "products/vectorscan/schema.yml"
    ],
    "mismatched_or_ambiguous": [],
    "evaluator_field_validation": {
      "required_signature": "evaluate(resource)",
      "found_signature": false,
      "pipeline_stage_structure_expected": ["normalization","validation","repair"],
      "pipeline_stage_structure_found": false
    },
    "schema_completeness": {
      "product_schema_found": false,
      "canonical_schema_used": "guardsuite-core/canonical_schema.json",
      "canonical_schema_valid": true,
      "missing_product_schema_fields": ["plan_id","schema_version","resources","metadata.source","metadata.ingested_at"]
    }
  },
  "compute": {
    "matched_evaluators": [
      "products/computescan/checklist/checklist.yml (documentation reference to evaluate(resource))"
    ],
    "matched_schemas": [
      "guardsuite-core/canonical_schema.json"
    ],
    "missing_evaluators": [
      "rule_specs/computeguard/evaluator.py",
      "rule_specs/computescan/evaluator.py"
    ],
    "missing_schemas": [
      "products/computeguard/schema.yml",
      "products/computescan/schema.yml"
    ],
    "mismatched_or_ambiguous": [],
    "evaluator_field_validation": {
      "required_signature": "evaluate(resource)",
      "found_signature": false,
      "notes": [
        "Only documentation/checklist references found; no concrete evaluator implementation under rule_specs/* detected.",
        "Runtime/pipeline overrides (evaluator.runtime_override) are present in snapshots and metadata but are repository-level annotations, not implementations."
      ]
    },
    "schema_completeness": {
      "product_schema_found": false,
      "canonical_schema_used": "guardsuite-core/canonical_schema.json",
      "canonical_schema_valid": true,
      "missing_product_schema_fields": ["plan_id","schema_version","resources","metadata.source","metadata.ingested_at"]
    }
  },
  "pipeline": {
    "matched_evaluators": [
      "strategy_e/pipeline/executor/pipeline_executor.py",
      "strategy_e/pipeline/executor/repair_steps.py"
    ],
    "matched_schemas": [
      "canonical_schemas/.gitkeep"
    ],
    "missing_evaluators": [
      "rule_specs/pipelineguard/evaluator.py",
      "rule_specs/pipelinescan/evaluator.py"
    ],
    "missing_schemas": [
      "products/pipelineguard/schema.yml",
      "products/pipelinescan/schema.yml"
    ],
    "mismatched_or_ambiguous": [],
    "evaluator_field_validation": {
      "required_signature": "evaluate(resource)",
      "found_signature": false,
      "pipeline_stage_structure_expected": ["normalization","validation","repair"],
      "pipeline_stage_structure_found": true,
      "notes": [
        "Found `run_pipeline_on_text` in pipeline executor which implements normalization/validation/repair stages expected by canonical evaluator pipeline.",
        "Executor does not expose `evaluate(resource)` signature; it operates on text and rule bundles instead (pipeline-level API)."
      ]
    },
    "schema_completeness": {
      "product_schema_found": false,
      "canonical_schema_used": null,
      "canonical_schema_valid": false,
      "missing_product_schema_fields": ["plan_id","schema_version","resources","metadata.source","metadata.ingested_at"]
    }
  },
  "missing": [
    "product-level schema files are missing for all mapped products (see per-pillar missing_schemas)",
    "concrete evaluator implementations under `rule_specs/*/evaluator.py` are missing for all pillars (only pipeline executor exists).",
    "product schemas are expected to include canonical fields: plan_id, schema_version, resources, metadata.source, metadata.ingested_at"
  ],
  "ambiguous": [
    "canonical_state/guard_suite_state.json references evaluator pipeline generically and cannot be attributed to a single pillar",
    "validation_integrity_snapshot/metadata.json contains canonical evaluator pipeline and policy info that is cross-cutting"
  ],
  "notes": [
    "Canonical schema artifact `guardsuite-core/canonical_schema.json` is present and validates structurally (contains required fields).",
    "Pipeline executor code exists and satisfies pipeline-stage expectations, but does not implement the `evaluate(resource)` signature used in product checklists.",
    "Recommend: (1) add product-level schema files under `products/*/schema.yml` following canonical schema, (2) implement per-product evaluator adapter exposing `evaluate(resource)` or document mapping from pipeline executor to evaluate signature, (3) decide ownership for orphan rule_specs and map them into pillars."
  ]
}
